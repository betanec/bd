Запросы на алгебре:
1.
Студенты, сдавшие только контрольную по одному курсу (понимаю как хотя бы одну контрольную по одному курсу).
Подзапрос:
Типы переменных: 
public_свод AS X, public_контрольные AS Y
Целевой список: X.*,Y.*
Тело запроса: 
(X[X.номер_ведомости=Y.номер_ведомости]Y)[Y.номер_ведомости]
saved as tab_1

Типы переменных: 
tab_1 AS X, tab_1 AS Z

Целевой список: 
X.номер_зачетки

Тело запроса:
(
(X
[X.номер_зачетки]) 
EXCEPT
((X[X.номер_зачетки=Z.номер_зачетки AND X.номер_ведомости<>Z.номер_ведомости]Z)[Z.@номер_зачетки])
)


Типы переменных: tab_2 AS X, public_студенты AS Y
Целевой список: Y.*
Тело запроса: 
(X[X.номер_зачетки=Y.номер_зачетки]Y)
.......................................

2.	Преподаватели, которые ставят одни «тройки»
Типы переменных: tab_1 AS X, tab_1 AS Z (таблица получена в 1 задании)
Целевой список: Z.номер_табеля_преподавателя
Тело запроса: 
(
(Z[Z.номер_табеля_преподавателя]) 
EXCEPT
((X[X.номер_табеля_преподавателя=Z.номер_табеля_преподавателя AND (X.свод="4" OR X.свод="5")])[X.номер_табеля_преподавателя])
)


Сохраним результат подзапроса в Ta3_504_Полякова
Типы переменных: Ta3_504_Полякова AS X, public_ПрепПр_json AS Y
Целевой список: Y.*
Тело запроса: 
(X[X.нПП=Y.нПП]Y)

3.	Студенты, сдавшие контрольные по всем курсам
Типы переменных: public_Студ_json AS X, Ta1_504_Полякова AS Y
Целевой список: Y.@нЗ, Y.нГ, X.фиоС
Тело запроса:  
(X[X.@нЗ=Y.@нЗ]Y)
Типы переменных: public_Оц_json AS X, public_Кр_json AS Y
Целевой список: X.*, Y.идК
Тело запроса: 
(X[X.нВ=Y.нВ]Y)

Типы переменных: Ta4_504_Полякова AS X, Ta5_504_Полякова AS Y, public_Кр_json AS Z
Целевой список: X.@нЗ, Z.идК
Тело запроса: 
(
 ((Z[Z.нГ=X.нГ]X)[X.@нЗ, Z.идК])
 EXCEPT
 (Y[Y.@нЗ, Y.идК])
)

Типы переменных: Ta1_504_Полякова AS X, public_Оц_json AS Y, Ta6_504_Полякова AS Z
Целевой список: X.@нЗ, X.нГ
Тело запроса: 
(
 ((Y[Y.@нЗ=X.@нЗ]X)[Y.@нЗ])
 EXCEPT
 (Z[Z.@нЗ])
)

Типы переменных: Ta7_504_Полякова AS X, public_Студ_json AS Y
Целевой список: X.@нЗ, X.нГ, Y.фиоС
Тело запроса: 
(X[X.@нЗ=Y.@нЗ]Y)

4.	Преподаватели, которые проверяли контрольные по всем курсам.
Типы переменных: public_ПрепПр_json AS X, Ta1_504_Полякова AS Y, public_Курс_json AS Z
Целевой список: X.*
Тело запроса: 
(
((X[X.нПП=Y.нПП]Y)[Y.идК])
DELETE
(Z[Z.идК])
)

5.	Преподаватели, которые проверяли контрольные только у одной группы

Типы переменных: public_ПрепПр_json AS X, Ta1_504_Полякова AS Y, Ta1_504_Полякова AS Z
Целевой список: X.*
Тело запроса: 
(
((X[X.нПП=Y.нПП]Y)[X.нПП])
EXCEPT
((Z[Z.нПП=Y.нПП AND Z.нГ<>Y.нГ]Y)[Z.нПП])
)
6.	Преподаватели, которые проверяли контрольные по двум курсам (= проверяли не более чем у 2 курсов – проверяли у одного курса)
Типы переменных: Ta1_504_Полякова AS X, Ta1_504_Полякова AS Y, Ta1_504_Полякова AS Z
Целевой список: Y.нПП
Тело запроса: 
(
(Y[Y.нПП])
EXCEPT
(((X[X.нПП=Y.нПП AND X.нПП=Z.нПП AND Y.нГ<>Z.нГ AND X.нГ<>Y.нГ]Y)
[X.нПП<>Z.нПП]Z)[X.нПП])
)

(подзапрос - проверяли только у одного курса)
Типы переменных: Ta1_504_Полякова AS X, Ta1_504_Полякова AS Y
Целевой список: X.нПП
Тело запроса: 
(
(X[X.нПП])
EXCEPT
((X[X.нПП=Y.нПП AND X.идК<>Y.идК]Y)[Y.нПП])
)

Типы переменных: Ta10_504_Полякова AS X, Ta11_504_Полякова AS Y, public_ПрепПр_json AS Z
Целевой список: X.нПП
Тело запроса: 
(
(X[X.нПП])
EXCEPT 
(Y[Y.нПП])
)

7.	Курсы лекций средние оценки по контрольным

select Кр_json."идК", avg(cast(Оц_json."оЦ" as int))
from Оц_json, Кр_json
where Оц_json."нВ" = Кр_json."нВ"
group by Кр_json.идК

8.	Курсы лекций, по которым нет студентов, написавших все контрольные на «отлично»

Подзапрос -  курсы лекций по которым есть студенты написавшие кр на отлично
Типы переменных: Ta5_504_Полякова AS X, Ta5_504_Полякова AS Y, Ta5_504_Полякова AS Z
Целевой список: X.идК, X.@нЗ
Тело запроса: 
(
 (X[X.идК, X.@нЗ])
 EXCEPT
((Y[Y.@нЗ=Z.@нЗ AND Y.идК=Z.идК AND (Y.оЦ="4" OR Y.оЦ="3")]Z)[Y.идК, Y.@нЗ])
)

Типы переменных: Ta5_504_Полякова AS X, Ta15_504_Полякова AS Y
Целевой список: X.идК
Тело запроса: 
(
 (X[X.идК, X.@нЗ])
 EXCEPT
 (Y[Y.идК, Y.@нЗ])
)

Типы переменных: public_Курс_json AS X, Ta17_504_Полякова AS Y
Целевой список: X.*
Тело запроса: 
(
(Y[Y.идК=X.идК]X)[Y.идК]
)

